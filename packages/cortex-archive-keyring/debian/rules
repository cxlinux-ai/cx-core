#!/usr/bin/make -f
# Cortex Archive Keyring Build Rules
# Copyright 2025 AI Venture Holdings LLC
# SPDX-License-Identifier: Apache-2.0

%:
	dh $@

override_dh_auto_build:
	# Generate keyring if key exists, otherwise use placeholder
	@if [ -f keys/cortex-archive-signing.gpg ]; then \
		cp keys/cortex-archive-signing.gpg cortex-archive-keyring.gpg; \
	else \
		echo "WARNING: Using placeholder keyring. Generate real keys before release."; \
		touch cortex-archive-keyring.gpg; \
	fi

override_dh_auto_install:
	install -d $(CURDIR)/debian/cortex-archive-keyring/usr/share/keyrings
	install -m 644 cortex-archive-keyring.gpg \
		$(CURDIR)/debian/cortex-archive-keyring/usr/share/keyrings/cortex-archive-keyring.gpg

override_dh_auto_clean:
	rm -f cortex-archive-keyring.gpg
